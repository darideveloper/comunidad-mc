{% extends "app/base.html" %}
{% load static %}

{% block main %}
<div class="regular-width content">
  <div class="profile-card-wrapper">
    {% include 'app/components/profile_card.html' %}
  </div>
  <div class="my-streams-shedule-form-wrapper">
    <div class="my-streams">
      
      <div class="title-card">
        <h2>MIS STREAMS</h2>
        <div class="decorator"></div>
      </div>
      
      <table>
        <thead>
          <tr>
            <th></th>
            <th>FECHA</th>
            <th>HORA</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for stream in streams %}
          <tr>
            <td>
              {% if stream.is_vip %}
                <img class="vip" src="{% static 'app/imgs/icon_oro.png' %}" alt="icono stream vip" title="Stream VIP">
              {% endif %}
            </td>
            <td>{{stream.date}}</td>
            <td>{{stream.time}}</td>
            <td>
              <button data-stream="{{stream.id}}" class="btn cancel form green {{stream.is_cancellable}}">Calcelar</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

    </div>
    <div class="shedule-form">

      <div class="title-card">
        <h2>AGENDAR</h2>
        <div class="decorator"></div>
      </div>

      <form action="." method="post">
        {% csrf_token %}

        <div class="date">
          <h3>Fecha</h3>
          <div class="select-wrapper">
            <div class="select">
              {% for day in available_days %}
              <label class="{% if day.disabled %}disabled{% endif %}{% if day.active %}active{% endif %}">
                {{day.name}}
                <input 
                  type="radio" 
                  name="date" 
                  value="{{day.date}}" 
                  date-text="{{day.date_text}}"
                  {% if day.disabled %}disabled{% endif %}
                  {% if day.active %}checked{% endif %}>
              </label>
              {% endfor %}
            </div>
          </div>
        </div>

        <div class="time">
          <h3>Hora</h3>
          <div class="select-wrapper">
            <div class="select">
              {% for hour in hours %}
                <label>
                  {{hour}}:00 hrs
                  <input type="radio" name="hour" value="{{hour}}">
                </label>
              {% endfor %}
            </div>
          </div>
        </div>

        <div class="confirmation">
          <h3>Confirma</h3>
          <p>
            <span class="day"></span>
            <span class="date"></span>
            <span class="time"></span>
            <span class="time-zone">(Zona horaria: {{time_zone}})</span>
          </p>

          {% if has_vips %}
          <div class="checkbox-wrapper">
            <label class="">
              Stream VIP
              <input type="checkbox" name="vip" id="vip">
            </label>
          </div>
          {% endif %}

          <input type="submit" class="btn form regular" value="confirmar" id="submit-btn" disabled>
        </div>

      </form>

    </div>
  </div>
</div>
{% endblock %}

{% block js %}
<script>
  const available_hours = {{available_hours|safe}};
  const hours = {{hours|safe}};
  const today_week_name = "{{today_week_name}}";
  const streams_date_times = {{streams_date_times|safe}}
</script>
<script src="{% static 'app/code/profile-card.js' %}" type="module"></script>
<script src="{% static 'app/code/schedule.js' %}" type="module"></script>
<script src="{% static 'app/code/checkbox.js' %}" type="module"></script>
{% endblock %}
